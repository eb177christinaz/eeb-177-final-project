# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/final-project/chiroptera/pyrate_mcmc_logs/newchiropteradata_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/final-project/chiroptera/pyrate_mcmc_logs/newchiropteradata_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.402447682821, 0.402447682821,0.13280196043,0.126963883416,0.126963883416,0.131758763778,0.131758763778,0.131758763778,0.131758763778,0.131758763778,0.131758763778,0.131758763778,0.131758763778,0.131758763778,0.131758763778,0.131758763778,0.131758763778,0.131758763778,0.131758763778,0.131758763778,0.0355676728512,0.0200601072943,0.00844156178016,0.00844156178016,0.000378885905647,0.000108915557208,0.000108915557208,0.000108915557208,0.000108915557208,0.000108915557208,0.000108915557208,0.0288892413655,0.0593488745221,0.078272673077,0.078721541583,0.0820341500532,0.078721541583,0.0820341500532,0.0830866798834,0.0820341500532,0.0820341500532,0.0820341500532,0.0720373672607,0.0697882140687,0.0660516860101,0.0697882140687,0.0880527626783,0.106713739676,0.110325842151,0.111931553979,0.121509565422,0.111931553979,0.127454049106,0.127454049106,0.127454049106,0.119730644202)
L_hpd_M95=c(0.987337343349, 0.987337343349,0.205655961213,0.198720153877,0.198720153877,0.202724375672,0.202724375672,0.202724375672,0.202724375672,0.202724375672,0.202724375672,0.202724375672,0.202724375672,0.202724375672,0.202724375672,0.202724375672,0.202724375672,0.202724375672,0.202724375672,0.202724375672,0.194764877581,0.186718184808,0.176422728106,0.169707105771,0.161012328912,0.111983296449,0.100568049912,0.0958302908144,0.0971065342353,0.105344037288,0.149116602957,0.195434902093,0.203598009803,0.199680779918,0.198234266715,0.199680779918,0.198491477269,0.198530629293,0.198530629293,0.198530629293,0.198530629293,0.198530629293,0.199680779918,0.234912996275,0.264122059409,0.30541622132,0.365488632849,0.379934169519,0.406080331174,0.417429852063,0.432120545363,0.437099990857,0.461530198289,0.461530198289,0.461530198289,0.675399892912)
M_hpd_m95=c(0.0473537810361, 0.0473537810361,0.0473537810361,0.0473537810361,0.0506189790722,0.0506189790722,0.0506189790722,0.0506189790722,0.0506189790722,0.0558652214158,0.0634194745573,0.0742723960764,0.0825246576303,0.0851267024219,0.0851267024219,0.0851267024219,0.0851267024219,0.0864617950833,0.0864617950833,0.0881532290228,0.0848489980528,0.0848489980528,0.0848489980528,0.0848489980528,0.0848489980528,0.0848489980528,0.0848489980528,0.0851267024219,0.0851267024219,0.0851267024219,0.0851267024219,0.0848489980528,0.0851267024219,0.0851267024219,0.0853740345352,0.0853740345352,0.0853740345352,0.0873902602515,0.0873902602515,0.0873902602515,0.0863464051844,0.0848489980528,0.0848489980528,0.0851267024219,0.0848489980528,0.0848489980528,0.0851267024219,0.0851267024219,0.08150418687,0.0851267024219,0.0851267024219,0.0851267024219,0.0851267024219,0.0851267024219,0.0851267024219,0.0851267024219)
M_hpd_M95=c(0.121001117127, 0.121001117127,0.121001117127,0.121001117127,0.125201141702,0.125201141702,0.125201141702,0.125201141702,0.125497126689,0.128400735,0.136157396859,0.143949295484,0.147667834164,0.145229761234,0.143697322038,0.143322800958,0.143322800958,0.143949295484,0.143949295484,0.143697322038,0.13877499936,0.137941190772,0.137941190772,0.136912040799,0.136912040799,0.136912040799,0.136912040799,0.136912040799,0.136912040799,0.136912040799,0.136912040799,0.136285992,0.136285992,0.135636604745,0.136157396859,0.136157396859,0.136157396859,0.136912040799,0.136912040799,0.136912040799,0.136912040799,0.136157396859,0.136157396859,0.136912040799,0.137941190772,0.139236369786,0.147667834164,0.161380227199,0.180920143959,0.214056861464,0.214429536954,0.214429536954,0.214056861464,0.214056861464,0.214056861464,0.214056861464)
R_hpd_m95=c(0.296619100199, 0.296619100199,0.0218473715207,0.0223751000321,0.0218473715207,0.0218473715207,0.0218473715207,0.0218473715207,0.0223751000321,0.0199318575292,0.00467988855556,0.00249156718785,0.00636159329776,0.00636159329776,0.00636159329776,0.00636159329776,0.00636159329776,0.00636159329776,0.00636159329776,0.00853631167919,-0.0600874645054,-0.100139066775,-0.105290052334,-0.108128111821,-0.114659855769,-0.12680770257,-0.121634477842,-0.121291723971,-0.121291723971,-0.120100674838,-0.11203035035,-0.0851515924981,-0.0543988183423,-0.0416678768028,-0.0388221350686,-0.0388221350686,-0.0388221350686,-0.0388221350686,-0.0347143509472,-0.0347143509472,-0.0388221350686,-0.031163097499,-0.0383583769467,-0.0683201393116,-0.0536524876706,-0.0383583769467,-0.031163097499,-0.0167570709427,-0.0165813222429,-0.0165813222429,-0.000662555477429,-0.0114675663494,0.000601842394247,-0.0114675663494,-0.0114675663494,-0.075400967235)
R_hpd_M95=c(0.881185882057, 0.881185882057,0.126707287792,0.126707287792,0.126707287792,0.128677887895,0.128677887895,0.128677887895,0.126707287792,0.126707287792,0.107497447573,0.100527036817,0.099002593979,0.099002593979,0.099002593979,0.099002593979,0.099002593979,0.099002593979,0.0983984328782,0.099002593979,0.099002593979,0.0847895992106,0.0784121691687,0.0745487679251,0.0636610110019,0.0108177825678,-0.00242709675083,-0.0063066864561,-0.00347142778047,0.00439849188575,0.0523239502178,0.0952227705184,0.0961705789594,0.096994037495,0.0961705789594,0.0952227705184,0.0952227705184,0.0941864711599,0.096994037495,0.096994037495,0.0935654207338,0.099499468033,0.10321913322,0.119328734545,0.166343571023,0.215885691178,0.269640312973,0.285819940766,0.301264765206,0.309670235499,0.328454421302,0.349969311428,0.376104176099,0.368627831853,0.368627831853,0.550066109345)
L_mean=c(0.679588611752, 0.679588611752,0.16356105046,0.162874249917,0.162922410617,0.16253189987,0.162587555109,0.162587555109,0.162587555109,0.162587555109,0.162587555109,0.162587555109,0.162587555109,0.162587555109,0.162587555109,0.162587555109,0.162587555109,0.162587555109,0.162587555109,0.162587555109,0.152342939245,0.122703409601,0.089005943092,0.0704217095587,0.0595874834228,0.0419074592529,0.0399657268226,0.0388106673734,0.0392184559693,0.0408797905301,0.0581031772391,0.115734094639,0.133567662725,0.137226127307,0.138863848177,0.138819219464,0.137306209637,0.136736940345,0.136940348725,0.137614986822,0.137614986822,0.138049751453,0.14137282415,0.145670311852,0.151638128931,0.163437560213,0.197042716151,0.219440079841,0.237005510185,0.247223629764,0.260045554795,0.27303245901,0.285049928455,0.28731836336,0.28731836336,0.333209570496)
M_mean=c(0.0937235571477, 0.0937235571477,0.0937235571477,0.0937235571477,0.0938329076303,0.0939195563468,0.0939394423552,0.094254411817,0.095517584356,0.0997127988711,0.10524813254,0.107000561339,0.108320870002,0.110089604342,0.110573809842,0.111187473915,0.111187473915,0.111107150699,0.110855608756,0.109978848711,0.108981604542,0.108840371842,0.108658448017,0.108657441684,0.108593300743,0.108702730255,0.108810165512,0.108786588851,0.108796025514,0.108753819691,0.108716784671,0.10848759269,0.108249584792,0.10822734486,0.108206323864,0.108243313454,0.108316123279,0.107877074449,0.107877074449,0.107877074449,0.107995238908,0.108338134548,0.1083702049,0.108495478232,0.108825327047,0.109185677546,0.111308895095,0.113187927704,0.117694895675,0.119593297552,0.120396986195,0.120481140733,0.120144698509,0.120144698509,0.120144698509,0.120144698509)
R_mean=c(0.585865054604, 0.585865054604,0.0698374933128,0.0691506927689,0.0690895029865,0.0686123435227,0.0686481127537,0.0683331432919,0.0670699707529,0.0628747562378,0.0573394225689,0.0555869937699,0.0542666851073,0.0524979507669,0.0520137452671,0.0514000811937,0.0514000811937,0.0514804044095,0.0517319463533,0.0526087063983,0.043361334703,0.0138630377595,-0.0196525049246,-0.0382357321258,-0.0490058173198,-0.0667952710022,-0.068844438689,-0.0699759214779,-0.0695775695447,-0.0678740291611,-0.0506136074323,0.00724650194948,0.0253180779327,0.0289987824479,0.0306575243133,0.0305759060102,0.0289900863581,0.0288598658956,0.0290632742759,0.0297379123732,0.0296197479147,0.029711616905,0.0330026192505,0.0371748336204,0.0428128018837,0.0542518826674,0.0857338210559,0.106252152137,0.11931061451,0.127630332212,0.139648568601,0.152551318276,0.164905229945,0.167173664851,0.167173664851,0.213064871987)
trans=0.5
age=(0:(56-1))* -1
plot(age,age,type = 'n', ylim = c(0, 1.08607107768), xlim = c(-58.8,2.8), ylab = 'Speciation rate', xlab = 'Ma',main='newchiropteradata' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 0.235872490649), xlim = c(-58.8,2.8), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-0.139488472827, 0.969304470263), xlim = c(-58.8,2.8), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-58.8,2.8), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()